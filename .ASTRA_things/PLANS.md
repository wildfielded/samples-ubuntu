# Заметки и поаны по тестам установки системного и прикладного ПО в Astra Linux #

Может оказаться полезным для автоматизации с помощью Ansible

----

## Содержание ##

1. [Установка](#установка)    
2. [Настройка сети](#настройка-сети)    
3. [Ввод в MS Domain по классике Linux]()    
4. [Ввод в MS Domain через astra-sssd-client](#домен-microsoft)    
5. [Автообновление записи в DNS]()    
6. [Установка FreeIPA и настройка доверительных отношений с MS AD]()    
7. [Ввод в FreeIPA]()    
8. [Printers]()    

----

## Установка ##

Здесь и далее речь пойдёт о Astra Linux Common Edition (дистрибутив
&laquo;Орёл&raquo;). При выборе устанавливаемого ПО надо добавить установку
SSH-сервера для того, чтобы далее иметь возможность удалённого администрирования
рабочей станции.

:arrow_right: Для экономии времени на настройки, на этапе установки при выборе
устанавливаемого ПО надо добавить установку SSH-сервера (&laquo;Средства удалённого
доступа SSH&raquo;) для того, чтобы далее иметь возможность удалённого
администрирования рабочей станции. Также при установке сразу запретить
&laquo;беспарольное&raquo; `sudo` и сказать системе, что время в BIOS выставлено
местное.

[:arrow_up: Содержание](#содержание)

----

## Настройка сети ##

:arrow_right: Настройки прокси-сервера можно задать в переменных окружения
`HTTPS_PROXY`, `HTTP_PROXY`, `FTP_PROXY` как глобально, так и для отдельного
конкретного пользователя. Глобально переменные окружения задаются в
**`/etc/environment`** или в **`/etc/environment.d/<any_name>`**:

```text
HTTPS_PROXY="http://proxyuser:password123@192.168.192.168:3128"
HTTP_PROXY="http://proxyuser:password123@192.168.192.168:3128"
FTP_PROXY="http://proxyuser:password123@192.168.192.168:3128"
```

Для исключений в **`/etc/environment`** добавляется строка со списком адресов:

```text
NO_PROXY="127.0.0.1, localhost, 192.168.0.0/24, wildfielded.site"
```

Если возникает необходимость задания для конкретного пользователя настроек
прокси, отличных от общесистемных, это можно сделать подобным образом в
пользовательском **`~/.bashrc`** или в **`~/.profile`**.

:arrow_right: Для работы **apt** создать файл **`/etc/apt/apt.conf.d/80proxy`**:

```bash
    touch /etc/apt/apt.conf.d/80proxy
```

и в нём прописать:

```text
Acquire::https::Proxy "http://proxyuser:password123@192.168.192.168:3128";
Acquire::http::Proxy "http://proxyuser:password123@192.168.192.168:3128";
Acquire::ftp::Proxy "http://proxyuser:password123@192.168.192.168:3128";
```

:arrow_right: Некоторые программы используют **wget**. Поэтому в файле
**`/etc/wgetrc`** надо задать подобные же параметры:

```text
https_proxy = http://proxyuser:password123@192.168.192.168:3128
http_proxy = http://proxyuser:password123@192.168.192.168:3128
ftp_proxy = http://proxyuser:password123@192.168.192.168:3128
```

[:arrow_up: Содержание](#содержание)

----

## Домен Microsoft ##

:arrow_right: Через **Synaptic** или **apt** установить:

```bash
apt install fly-admin-ad-sssd-client
```

Ввод в домен производится через &laquo;Панель управления&raquo; :arrow_right:
&laquo;Сеть&raquo; :arrow_right: &laquo;Настройка клиента SSSD Fly&raquo;. При
этом компьютер появляется в структуре Active Directory. После перезагрузки можно
входить в систему под доменным логином, предварительно выбрав домен.

Чтобы на данном этапе у администраторов была возможность выполнять команды через
`sudo` и для будущей автоматизации можно создать файл
**`/etc/sudoers.d/astra_admins`**, и в нём прописать:

[:arrow_up: Содержание](#содержание)

----
